<!DOCTYPE html>
<html>
<head>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <meta charset="UTF-8">
  <title>Scrap Mechanic Keybinds Editor</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <div class="controls">
      <input type="file" id="keybindsFile" autocomplete="off">
      <button id="download" style="float: right">Download</button>
    </div>
    <div class="controls">
      <span id="version">N/A</span>
    </div>
    <div class="controls">
      <label><input id="showConflicts" type="checkbox" autocomplete="off">Highlight <em>potential</em> conflicts</label>
    </div>

    <table id="keybindsTable" border="1">
      <thead>
        <tr>
          <th>Action</th>
          <th>Keybinds</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>

    <div>The following notes apply to keybinds version 7:</div>
    <ul>
      <li>This tool enables the modification of specific keybinds that cannot be altered from the in-game settings. It also allows the assignment of more than two keybinds per action or even the removal of all keybinds entirely.</li>

      <li>Locate <span class="mono">keybinds.json</span> in <span class="mono">C:\<wbr>Users\<wbr>your_user_name\<wbr>AppData\<wbr>Roaming\<wbr>Axolot&nbsp;Games\<wbr>Scrap&nbsp;Mechanic\<wbr>User\<wbr>User_XXXXXXXXXXXXXXXXX\</span>.</li>

      <li>Before making changes, create a backup copy of <span class="mono">keybinds.json</span>.</li>

      <li>Within the game settings, reset the controls to their default configuration, and then make a valid keybind change for any action. This process will ensure that a complete and updated version of <span class="mono">keybinds.json</span> is saved.</li>

      <li>Upload <span class="mono">keybinds.json</span> to the editor with the <span class="mono">Browse</span> button. To alter keybinds, simply click on one, make the desired changes, and then click <span class="mono">Save</span>. Keybinds can be removed similarly by clicking on <span class="mono">Delete</span> instead. Click on the <span class="mono">+</span> signs to add new keybinds.</li>

      <li>The checkbox to highlight potential conflicts only performs a "dumb" check. Keybinds will be highlighted as long as the code detects the same keybind in more than one place. Some actions can share keybinds with no issues in-game (detailed below). A tooltip will be displayed when hovering over a conflicting keybind, showing other actions that are using the same keybind.</li>

      <li>Actions with the prefix <span class="mono">C_</span> (likely denoting Creation) are specific to actions performed while the character is in a seat.</li>

      <li>The in-game hotbar can hold two categories of items: one for tools, parts, and building blocks, and the other for the buttons and switches connected to a seat. These are, in fact, two distinct hotbars (referred to as the regular hotbar and the creation hotbar), with the former mapped to the <span class="mono">MenuItem0</span>-<span class="mono">MenuItem9</span> actions and the latter mapped to the <span class="mono">C_Item0</span>-<span class="mono">C_Item9</span> actions. In-game settings are limited to assigning the same keybinds to both sets of hotbars, but the editor allows for different keybinds. This holds true for the other <span class="mono">C_</span> actions as well.</li>

      <li>Most keybinds for non-prefixed actions can be reused for prefixed actions without any issues. For example, the keybind(s) for the <span class="mono">Sprint</span> action (<span class="mono">Shift</span> by default) can also be simultaneously used as the keybind(s) for one of the creation hotbar slots because the character cannot sprint while in a seat. On the other hand, the keybind(s) for the <span class="mono">Handbook</span> action (<span class="mono">H</span> by default) cannot be reused, as a character in a seat can still pull up the handbook.</li>

      <li>The <span class="mono">C_Create</span> and <span class="mono">C_Attack</span> actions are bound to the left and right mouse clicks by default and cannot be modified in-game. In terms of functionality, these two actions are replicas of the <span class="mono">C_Item0</span> and <span class="mono">C_Item1</span> actions, which correspond to the first two slots of the creation hotbar. The editor renders the <span class="mono">C_Create</span> and <span class="mono">C_Attack</span> actions redundant since it allows mouse clicks to be directly assigned to any of the creation hotbar slots.</li>

      <li>Both the <span class="mono">C_Jump</span> and <span class="mono">C_Use</span> actions serve the purpose of exiting a seat however, only one of them is necessary. If multiple keybinds are required, they can be assigned to a single action.</li>

      <li>Modifying/Adding keybinds for <span class="mono">C_ZoomIn</span> and <span class="mono">C_ZoomOut</span> actions have no effect. The actions seem to be hard-coded to <span class="mono">Alt&nbsp;+&nbsp;ScrollUp/ScrollDown</span> in the game.</li>

      <li>Keybinds for the <span class="mono">Camera</span> action also has no impact. Most likely, the action was intended for changing camera modes but is hard-coded to <span class="mono">Ctrl</span> in the game.</li>

      <li>Scrap Mechanic does not recognise numpad keys.</li>

      <li>Unassigning all keybinds from an action may cause the game to completely remove that action from <span class="mono">keybinds.json</span>. This could occur when you make a keybind change from the in-game settings.</li>

      <li>Download the modified keybinds.json file when done modifying and place it back in the directory. Ensure that the file extension is <span class="mono">.json</span>.</li>

      <li>Any adjustments made to <span class="mono">keybinds.json</span> will only take effect after reloading the game (exit completely and then relaunch).</li>
    </ul>

    <div id="keybindEditModal">
      <div class="modal-content">
        <div id="action"></div>

        <div>
          <label><input id="isCtrl" type="checkbox" autocomplete="off">Ctrl</label>
          <label><input id="isShift" type="checkbox" autocomplete="off">Shift</label>
          <label><input id="isAlt" type="checkbox" autocomplete="off">Alt</label>

          <select id="keysList">
            <optgroup label="Mouse">
              <option value="MB_0">Mouse1</option>
              <option value="MB_1">Mouse2</option>
              <option value="MB_2">Mouse3</option>
              <option value="MB_3">Mouse4</option>
              <option value="MB_4">Mouse5</option>
              <option value="MB_5">Mouse6</option>
              <option value="MB_6">Mouse7</option>
              <option value="MS_1">ScrollUp</option>
              <option value="MS_-1">ScrollDown</option>
            </optgroup>
            <optgroup label="Control keys">
              <option value="K_8">Backspace</option>
              <option value="K_9">Tab</option>
              <option value="K_13">Enter</option>
              <option value="K_16">Shift</option>
              <option value="K_17">Ctrl</option>
              <option value="K_18">Alt</option>
              <option value="K_19">Pause</option>
              <option value="K_20">CapsLock</option>
              <option value="K_27">Escape</option>
              <option value="K_32">Space</option>
              <option value="K_33">PageUp</option>
              <option value="K_34">PageDown</option>
              <option value="K_35">End</option>
              <option value="K_36">Home</option>
              <option value="K_37">ArrowLeft</option>
              <option value="K_38">ArrowUp</option>
              <option value="K_39">ArrowRight</option>
              <option value="K_40">ArrowDown</option>
              <option value="K_45">Insert</option>
              <option value="K_46">Delete</option>
            </optgroup>
            <optgroup label="Number keys">
              <option value="K_48">0</option>
              <option value="K_49">1</option>
              <option value="K_50">2</option>
              <option value="K_51">3</option>
              <option value="K_52">4</option>
              <option value="K_53">5</option>
              <option value="K_54">6</option>
              <option value="K_55">7</option>
              <option value="K_56">8</option>
              <option value="K_57">9</option>
            </optgroup>
            <optgroup label="Letter keys">
              <option value="K_65">A</option>
              <option value="K_66">B</option>
              <option value="K_67">C</option>
              <option value="K_68">D</option>
              <option value="K_69">E</option>
              <option value="K_70">F</option>
              <option value="K_71">G</option>
              <option value="K_72">H</option>
              <option value="K_73">I</option>
              <option value="K_74">J</option>
              <option value="K_75">K</option>
              <option value="K_76">L</option>
              <option value="K_77">M</option>
              <option value="K_78">N</option>
              <option value="K_79">O</option>
              <option value="K_80">P</option>
              <option value="K_81">Q</option>
              <option value="K_82">R</option>
              <option value="K_83">S</option>
              <option value="K_84">T</option>
              <option value="K_85">U</option>
              <option value="K_86">V</option>
              <option value="K_87">W</option>
              <option value="K_88">X</option>
              <option value="K_89">Y</option>
              <option value="K_90">Z</option>
            </optgroup>
            <optgroup label="Function keys">
              <option value="K_112">F1</option>
              <option value="K_113">F2</option>
              <option value="K_114">F3</option>
              <option value="K_115">F4</option>
              <option value="K_116">F5</option>
              <option value="K_117">F6</option>
              <option value="K_118">F7</option>
              <option value="K_119">F8</option>
              <option value="K_120">F9</option>
              <option value="K_121">F10</option>
              <option value="K_122">F11</option>
              <option value="K_123">F12</option>
              <option value="K_124">F13</option>
              <option value="K_125">F14</option>
              <option value="K_126">F15</option>
              <option value="K_127">F16</option>
              <option value="K_128">F17</option>
              <option value="K_129">F18</option>
              <option value="K_130">F19</option>
              <option value="K_131">F20</option>
              <option value="K_132">F21</option>
              <option value="K_133">F22</option>
              <option value="K_134">F23</option>
              <option value="K_135">F24</option>
              <option value="K_136">F25</option>
              <option value="K_137">F26</option>
              <option value="K_138">F27</option>
              <option value="K_139">F28</option>
              <option value="K_140">F29</option>
              <option value="K_141">F30</option>
              <option value="K_142">F31</option>
              <option value="K_143">F32</option>
            </optgroup>
            <optgroup label="Special keys">
              <option value="K_144">NumLock</option>
              <option value="K_145">ScrollLock</option>
              <option value="K_186">;</option>
              <option value="K_187">=</option>
              <option value="K_188">,</option>
              <option value="K_189">-</option>
              <option value="K_190">.</option>
              <option value="K_191">/</option>
              <option value="K_192">`</option>
              <option value="K_219">[</option>
              <option value="K_220">\</option>
              <option value="K_221">]</option>
              <option value="K_222">'</option>
            </optgroup>
          </select>
        </div>

        <div>
          <button id="save">Save</button>
          <button id="delete">Delete</button>
        </div>
      </div>
    </div>

    <div id="tooltip"></div>
  </div>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
